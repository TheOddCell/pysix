#!/usr/bin/env python3
import sys

args = sys.argv[1:]
mode = None      # 'b', 'c', or 'f'
list_arg = None
delim = '\t'
suppress = False
files = []

# --- arg parsing ---
i = 0
while i < len(args):
    a = args[i]
    if a == "-b" or a == "-c" or a == "-f":
        mode = a[1]
        i += 1
        list_arg = args[i]
    elif a == "-d":
        i += 1
        delim = args[i]
    elif a == "-s":
        suppress = True
    else:
        files.append(a)
    i += 1

if mode is None:
    print("cut: you must specify -b, -c, or -f", file=sys.stderr)
    sys.exit(1)

# --- parse list ---
ranges = []
for part in list_arg.replace(',', ' ').split():
    if '-' in part:
        if part == '-':
            continue
        if part.startswith('-'):
            # -high
            high = int(part[1:])
            ranges.append((1, high))
        elif part.endswith('-'):
            # low-
            low = int(part[:-1])
            ranges.append((low, None))
        else:
            # low-high
            low, high = part.split('-', 1)
            ranges.append((int(low), int(high)))
    else:
        n = int(part)
        ranges.append((n, n))

# --- file iterator ---
if not files:
    files = ["-"]

def readfile(path):
    if path == "-":
        for line in sys.stdin:
            yield line
    else:
        with open(path, "r", errors="replace") as f:
            for line in f:
                yield line

# --- processing loop ---
for f in files:
    for line in readfile(f):
        line = line.rstrip('\n')

        if mode == 'b' or mode == 'c':
            out = []
            ln = len(line)
            for lo, hi in ranges:
                if hi is None:
                    hi = ln
                lo = max(lo, 1)
                hi = max(hi, 0)
                if lo <= ln and hi >= 1 and lo <= hi:
                    out.append(line[lo-1:hi])
            sys.stdout.write("".join(out) + "\n")

        else:  # mode == 'f'
            if delim not in line:
                if not suppress:
                    sys.stdout.write(line + "\n")
                continue

            fields = line.split(delim)
            out = []
            fcount = len(fields)
            seen = set()

            for lo, hi in ranges:
                if hi is None:
                    hi = fcount
                lo = max(lo, 1)
                hi = max(hi, 0)
                for idx in range(lo, hi+1):
                    if 1 <= idx <= fcount:
                        if idx not in seen:
                            out.append(fields[idx-1])
                            seen.add(idx)

            sys.stdout.write(delim.join(out) + "\n")
