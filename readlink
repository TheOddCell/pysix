#!/usr/bin/env python3
import os
import sys

argv = sys.argv[1:]
newline = True

# Parse only -n (POSIX)
if argv and argv[0] == "-n":
    newline = False
    argv = argv[1:]

# Must have exactly one operand
if len(argv) != 1:
    sys.stderr.write("readlink: missing operand\n" if len(argv) == 0
                     else "readlink: too many arguments\n")
    sys.exit(1)

path = argv[0]

# Must be a symbolic link
if not os.path.islink(path):
    sys.stderr.write(f"readlink: {path}: Not a symbolic link\n")
    sys.exit(1)

try:
    target = os.readlink(path)
except OSError as e:
    sys.stderr.write(f"readlink: {path}: {e}\n")
    sys.exit(1)

# Output
sys.stdout.write(target)
if newline:
    sys.stdout.write("\n")

sys.exit(0)
