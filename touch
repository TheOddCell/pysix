#!/usr/bin/env python3import sysimport osimport timefrom datetime import datetimeargs = sys.argv[1:]update_access = Trueupdate_mod = Truecreate = Trueref_file = Nonetimestamp = Nonefiles = []i = 0while i < len(args):    arg = args[i]    if arg == '-a':        update_mod = False    elif arg == '-m':        update_access = False    elif arg == '-c':        create = False    elif arg == '-r':        i += 1        if i < len(args):            ref_file = args[i]        else:            print("touch: missing argument for -r", file=sys.stderr)            sys.exit(1)    elif arg in ('-t', '-d'):        i += 1        if i < len(args):            ts = args[i]            if arg == '-t':                # [[CC]YY]MMDDhhmm[.SS]                try:                    if '.' in ts:                        t, s = ts.split('.')                        dt = datetime.strptime(t, "%Y%m%d%H%M")                        sec = int(s)                    else:                        dt = datetime.strptime(ts, "%Y%m%d%H%M")                        sec = 0                    timestamp = dt.timestamp() + sec                except Exception as e:                    print(f"touch: invalid time format: {ts}", file=sys.stderr)                    sys.exit(1)            else:  # -d ISO 8601                try:                    dt = datetime.fromisoformat(ts)                    timestamp = dt.timestamp()                except Exception as e:                    print(f"touch: invalid date_time format: {ts}", file=sys.stderr)                    sys.exit(1)        else:            print(f"touch: missing argument for {arg}", file=sys.stderr)            sys.exit(1)    else:        files.append(arg)    i += 1if not files:    print("touch: missing file operand", file=sys.stderr)    sys.exit(1)if ref_file:    try:        ts_access = ts_mod = os.stat(ref_file).st_mtime    except Exception as e:        print(f"touch: {ref_file}: {e}", file=sys.stderr)        sys.exit(1)else:    ts_access = ts_mod = timestamp if timestamp is not None else time.time()for f in files:    if not os.path.exists(f):        if create:            try:                open(f, 'a').close()            except Exception as e:                print(f"touch: {f}: {e}", file=sys.stderr)                continue        else:            continue    try:        current_times = os.stat(f)        atime = ts_access if update_access else current_times.st_atime        mtime = ts_mod if update_mod else current_times.st_mtime        os.utime(f, (atime, mtime))    except Exception as e:        print(f"touch: {f}: {e}", file=sys.stderr)        sys.exit(1)sys.exit(0)